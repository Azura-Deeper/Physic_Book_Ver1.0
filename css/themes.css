/* Dark Theme */
[data-theme="dark"] {
    --primary-color: #3b82f6;
    --secondary-color: #6366f1;
    --accent-color: #06b6d4;
    --text-color: #f9fafb;
    --text-secondary: #d1d5db;
    --background-color: #111827;
    --surface-color: #1f2937;
    --border-color: #374151;
    --shadow-light: 0 1px 3px rgba(0, 0, 0, 0.3);
    --shadow-medium: 0 4px 6px rgba(0, 0, 0, 0.3);
    --shadow-large: 0 10px 15px rgba(0, 0, 0, 0.3);
}

/* Light Theme (Default) */
[data-theme="light"] {
    --primary-color: #2563eb;
    --secondary-color: #3b82f6;
    --accent-color: #06b6d4;
    --text-color: #1f2937;
    --text-secondary: #6b7280;
    --background-color: #ffffff;
    --surface-color: #f8fafc;
    --border-color: #e5e7eb;
    --shadow-light: 0 1px 3px rgba(0, 0, 0, 0.1);
    --shadow-medium: 0 4px 6px rgba(0, 0, 0, 0.1);
    --shadow-large: 0 10px 15px rgba(0, 0, 0, 0.1);
}

/* High Contrast Theme */
[data-theme="high-contrast"] {
    --primary-color: #000000;
    --secondary-color: #333333;
    --accent-color: #0066cc;
    --text-color: #000000;
    --text-secondary: #333333;
    --background-color: #ffffff;
    --surface-color: #f0f0f0;
    --border-color: #000000;
    --shadow-light: 0 1px 3px rgba(0, 0, 0, 0.5);
    --shadow-medium: 0 4px 6px rgba(0, 0, 0, 0.5);
    --shadow-large: 0 10px 15px rgba(0, 0, 0, 0.5);
}

/* Sepia Theme */
[data-theme="sepia"] {
    --primary-color: #8b4513;
    --secondary-color: #a0522d;
    --accent-color: #cd853f;
    --text-color: #3d2914;
    --text-secondary: #8b7355;
    --background-color: #f4f1ea;
    --surface-color: #ede6d3;
    --border-color: #d2b48c;
    --shadow-light: 0 1px 3px rgba(61, 41, 20, 0.1);
    --shadow-medium: 0 4px 6px rgba(61, 41, 20, 0.1);
    --shadow-large: 0 10px 15px rgba(61, 41, 20, 0.1);
}

/* Theme Transition */
* {
    transition: background-color var(--transition-normal), 
                color var(--transition-normal), 
                border-color var(--transition-normal);
}

/* Dark Theme Specific Adjustments */
[data-theme="dark"] .header {
    background: linear-gradient(135deg, #1f2937, #374151);
}

[data-theme="dark"] .math-display {
    background: var(--surface-color);
    color: var(--text-color);
}

[data-theme="dark"] .definition-box {
    background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(99, 102, 241, 0.1));
}

[data-theme="dark"] .important-note {
    background: linear-gradient(135deg, rgba(245, 158, 11, 0.1), rgba(251, 191, 36, 0.1));
}

[data-theme="dark"] .app-card.positive {
    background: linear-gradient(135deg, rgba(34, 197, 94, 0.1), rgba(74, 222, 128, 0.1));
}

[data-theme="dark"] .app-card.negative {
    background: linear-gradient(135deg, rgba(239, 68, 68, 0.1), rgba(248, 113, 113, 0.1));
}

[data-theme="dark"] .examples li {
    background: rgba(6, 182, 212, 0.2);
}

[data-theme="dark"] .formula-explanation li {
    background: rgba(59, 130, 246, 0.1);
}

[data-theme="dark"] .quiz-options label:hover {
    background: rgba(59, 130, 246, 0.1);
}

/* High Contrast Theme Adjustments */
[data-theme="high-contrast"] .header {
    background: #000000;
}

[data-theme="high-contrast"] .btn-icon {
    background: #000000;
    border: 2px solid #ffffff;
}

[data-theme="high-contrast"] .toc-list a:hover,
[data-theme="high-contrast"] .toc-list a.active {
    background: #000000;
    color: #ffffff;
}

[data-theme="high-contrast"] .info-card:hover,
[data-theme="high-contrast"] .formula-box:hover,
[data-theme="high-contrast"] .concept-box:hover {
    box-shadow: 0 0 0 3px #000000;
}

/* Sepia Theme Adjustments */
[data-theme="sepia"] .header {
    background: linear-gradient(135deg, #8b4513, #a0522d);
}

[data-theme="sepia"] .examples li {
    background: rgba(205, 133, 63, 0.2);
}

[data-theme="sepia"] .formula-explanation li {
    background: rgba(139, 69, 19, 0.1);
}

/* Theme Toggle Button */
.theme-selector {
    position: relative;
    display: inline-block;
}

.theme-dropdown {
    position: absolute;
    top: 100%;
    right: 0;
    background: var(--surface-color);
    border: 1px solid var(--border-color);
    border-radius: var(--border-radius);
    box-shadow: var(--shadow-medium);
    padding: var(--spacing-sm);
    min-width: 150px;
    z-index: 1000;
    opacity: 0;
    visibility: hidden;
    transform: translateY(-10px);
    transition: all var(--transition-fast);
}

.theme-dropdown.show {
    opacity: 1;
    visibility: visible;
    transform: translateY(0);
}

.theme-option {
    display: block;
    width: 100%;
    padding: var(--spacing-sm);
    background: none;
    border: none;
    text-align: left;
    color: var(--text-color);
    cursor: pointer;
    border-radius: var(--border-radius);
    transition: background-color var(--transition-fast);
}

.theme-option:hover {
    background: rgba(0, 0, 0, 0.05);
}

[data-theme="dark"] .theme-option:hover {
    background: rgba(255, 255, 255, 0.05);
}

.theme-option.active {
    background: var(--primary-color);
    color: white;
}

/* Reading Mode Adjustments */
.reading-mode {
    --font-size-base: 1.125rem;
    --font-size-lg: 1.25rem;
    --font-size-xl: 1.375rem;
    --font-size-2xl: 1.625rem;
    --font-size-3xl: 2rem;
    line-height: 1.8;
}

.reading-mode .content {
    max-width: 800px;
    margin: 0 auto;
}

.reading-mode .sidebar {
    display: none;
}

/* Accessibility Enhancements for Themes */
@media (prefers-color-scheme: dark) {
    :root {
        --primary-color: #3b82f6;
        --secondary-color: #6366f1;
        --accent-color: #06b6d4;
        --text-color: #f9fafb;
        --text-secondary: #d1d5db;
        --background-color: #111827;
        --surface-color: #1f2937;
        --border-color: #374151;
    }
}

@media (prefers-contrast: high) {
    :root {
        --primary-color: #000000;
        --secondary-color: #333333;
        --accent-color: #0066cc;
        --text-color: #000000;
        --text-secondary: #333333;
        --background-color: #ffffff;
        --surface-color: #f0f0f0;
        --border-color: #000000;
    }
}

/* Focus Indicators for All Themes */
button:focus-visible,
a:focus-visible,
input:focus-visible {
    outline: 3px solid var(--accent-color);
    outline-offset: 2px;
}

[data-theme="high-contrast"] button:focus-visible,
[data-theme="high-contrast"] a:focus-visible,
[data-theme="high-contrast"] input:focus-visible {
    outline: 3px solid #0066cc;
    outline-offset: 2px;
}